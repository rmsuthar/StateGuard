const StateGuard=function(){const t=new Map;class e{constructor(t,e){this.el=t,this.attrs=e.attributes||"all",this.limit=e.maxAttempts||3,this.callback=e.onViolation||null,this.snap={},this.count=0,this.locked=!1,this.save(),this.watch()}save(){this.snap={},Array.from(this.el.attributes).forEach(t=>this.snap[t.name]=t.value)}watch(){this.obs=new MutationObserver(t=>{this.locked||t.forEach(t=>{("all"===this.attrs||this.attrs.includes(t.attributeName))&&(this.count++,this.revert(t.attributeName),this.callback&&this.count>=this.limit&&this.callback(this.el,this.count))})}),this.obs.observe(this.el,{attributes:!0})}revert(t){void 0!==this.snap[t]?this.el.setAttribute(t,this.snap[t]):this.el.removeAttribute(t)}exec(t){this.locked=!0,t(this.el),this.save(),this.locked=!1}}return window.console.clear=()=>{console.warn("Console clearing is disabled for security auditing.")},{protect:(s,i)=>{document.querySelectorAll(s).forEach(s=>t.set(s,new e(s,i)))},update:(e,s)=>t.get(e)?.exec(s),destruct:()=>{t.forEach(t=>t.obs.disconnect()),t.clear()}}}();"undefined"!=typeof module&&module.exports&&(module.exports=StateGuard);